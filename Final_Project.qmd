---
title: "Stat 330 Final Project"
author: Christopher Gordon, Talmage Hilton, Ty Hawkes
output: pdf_document
---

<style type="text/css">
h1.title {
font-size: 40px;
text-align: center;
}
h4.author {
font-size: 40px;
text-align: center;
}
</style>

\newpage

```{r setup, include=FALSE}
library(tidyverse)
library(car)
library(glmnet)
library(ggfortify)
library(vroom)
```

# Abstract

Here, you will briefly summarize the entire report, including the data used, questions of interest, and relevant findings.

# 1 Problem and Motivation

In this section, you will describe the background information about the study that is necessary to understand why the data are important.  In other words, why was it important to gather the data in the first place?

## 1.1 Data Description

Briefly state the source of your data and describe the relevant variables that **you will use** in your project.  Include important details such as units for the different variables, and what the ``observational units" (rows in the data set) represent (e.g., individuals, countries, etc.)

```{r, warning = False, message = False}
df <- vroom('Cancer_Data.csv') %>%
  mutate(diagnosis = as.factor(diagnosis)) %>%
  select(diagnosis, radius_mean, texture_mean, perimeter_mean, area_mean, smoothness_mean, compactness_mean, concavity_mean, `concave points_mean`, symmetry_mean, fractal_dimension_mean)
```

## 1.2 Questions of Interest

Briefly and clearly state the two main questions that you will investigate throughout the report.  These questions should be stated in scientific, and not statistical language.  For example, "Is the slope of log of per capita GDP significantly different from zero?" should instead by give as "Does the log of per capita GDP have an effect on the average life expectancy of females in a given country?"

"Can we predict whether a tumor is malignant of benign based on the data provided?"
"Is there a statistically significant relationship between the mean radius of a tumor, and whether it is malignant or not"

## 1.3 Regression Methods

For each question of interest listed in Section 2, describe what regression models, techniques, and tools you will use to fully answer it.  These should include any plots you will use for exploratory analysis or diagnostic checks, as well as methods of inference you will use. 

```{r}
df.lm = glm(diagnosis ~ ., data = df, family = binomial(link = 'logit'))
vif(df.lm)
```

LASSO 
```{r}
df_x <- as.matrix(select(df, -diagnosis)) # predictors
df_y <- unlist(select(df, diagnosis) %>%
                  mutate(diagnosis = ifelse(diagnosis == 'M', 1, 0))) # response

# use cross validation to pick the "best" (based on MSE) lambda
df_LASSO_cv <- cv.glmnet(x = df_x, # automatically includes a column of ones for the intercept FYI
                          y = df_y, 
                          type.measure = "auc", 
                          alpha = 1) # 0 is code for "ridge regression"

# plot (log) lambda vs MSE
autoplot(df_LASSO_cv, label = FALSE) +
  theme_bw() +
  theme(aspect.ratio = 1)

# lambda.min: value of lambda that gives minimum mean cross-validated error
df_LASSO_cv$lambda.min
# lambda.1se: value of lambda within 1 standard error of the minimum 
# cross-validated error
df_LASSO_cv$lambda.1se

coef(df_LASSO_cv, s = "lambda.min")
coef(df_LASSO_cv, s = "lambda.1se")
```

ELASTIC NET SELECTION
```{r}
df_x <- as.matrix(select(df, -diagnosis)) # predictors
df_y <- unlist(select(df, diagnosis) %>%
                  mutate(diagnosis = ifelse(diagnosis == 'M', 1, 0))) # response

# use cross validation to pick the "best" (based on MSE) lambda
df_LASSO_cv <- cv.glmnet(x = df_x, # automatically includes a column of ones for the intercept FYI
                          y = df_y, 
                          type.measure = "auc", 
                          alpha = .5) # 0 is code for "ridge regression"

# plot (log) lambda vs MSE
autoplot(df_LASSO_cv, label = FALSE) +
  theme_bw() +
  theme(aspect.ratio = 1)

# lambda.min: value of lambda that gives minimum mean cross-validated error
df_LASSO_cv$lambda.min
# lambda.1se: value of lambda within 1 standard error of the minimum 
# cross-validated error
df_LASSO_cv$lambda.1se

coef(df_LASSO_cv, s = "lambda.min")
coef(df_LASSO_cv, s = "lambda.1se")
```

```{r}
df.lm = glm(diagnosis ~ radius_mean + texture_mean + 
              `concave points_mean` + smoothness_mean + symmetry_mean, 
            data = df, family = binomial(link = 'logit'))
summary(df.lm)
vif(df.lm)
```

# 2 Analyses, Results, and Interpretation

Conduct the analysis in a logical fashion, including necessary code (and not any superfluous code) and its output.  Give simple interpretations of your findings related to the questions of interest.

# 3 Conclusions

Give additional context to you results and interpretations from Section 5 with respect to the data set and its purpose.  Describe any potential weaknesses in your analysis, and how they may affect the reliability of the results.

# 4 Contributions

For each member of the group, write a short paragraph describing their contribution to this project and the report.  It is up to you to decide how to divide up the work, so long as everyone is contributing approximately equally. 

## APPENDIX

If there are any analyses, such as exploratory plots/summaries or work you did to determine appropriate transformations, or any relevant material that does not belong in one of the sections above, these can go in the Appendix.  If you don't have any material like this, you can remove this section.


